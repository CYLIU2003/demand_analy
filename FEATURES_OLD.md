# ⚡ Grid Demand Insights - 機能詳細ガイド

このドキュメントでは、Python版アプリケーションの全機能を詳しく説明します。

## 📑 目次

1. [メインタブ - データ閲覧とグラフ表示](#1-メインタブ)
2. [統計分析・予測タブ - 高度な分析とAI予測](#2-統計分析予測タブ)
3. [気象データ統合](#3-気象データ統合)
4. [データ可用性タブ](#4-データ可用性タブ)
5. [発電種別比較タブ](#5-発電種別比較タブ)
6. [数値比較分析タブ](#6-数値比較分析タブ)

---

## 1. メインタブ - データ閲覧とグラフ表示

### 概要
電力需給データの基本的な閲覧とグラフ表示を行います。

### 機能詳細

## 📊 詳細分析タブ（統計分析）

### 基本統計量レポート
- **記述統計**: サンプル数、平均値、中央値、標準偏差
- **分位統計**: 最小値、最大値、25%分位点、75%分位点、四分位範囲
- **分布特性**: 歪度（skewness）、尖度（kurtosis）、変動係数（CV）

### 時系列トレンド分析
- 需要実績と発電実績の時系列プロット
- 長期トレンドの可視化
- 複数系列の同時表示

### 分布特性分析
- **ヒストグラム**: 
  - データの頻度分布
  - 平均値と中央値のマーカー表示
- **箱ひげ図（Box Plot）**:
  - 四分位範囲の視覚化
  - 外れ値の自動検出

### 相関分析
- 発電方式間の相関係数行列
- ヒートマップによる視覚化
- 相関係数の数値表示（-1.0 〜 +1.0）

### 時間帯別需要パターン分析
- 24時間の時刻別平均値
- 標準偏差による信頼区間
- ピーク時間帯の特定

## 🤖 AI分析タブ（時系列予測）

### 1. STL時系列分解
- **トレンド成分**: 長期的な傾向
- **季節性成分**: 周期的なパターン（24時間周期）
- **残差成分**: ランダムな変動
- 各成分の統計量レポート

### 2. ARIMA予測
- **モデル**: ARIMA(5, 1, 0)
- **機能**:
  - 自動的な訓練/テストデータ分割
  - 指定期間の予測
  - 実測値との比較プロット
- **評価指標**:
  - MAE（平均絶対誤差）
  - RMSE（二乗平均平方根誤差）
  - MAPE（平均絶対パーセント誤差）

### 3. Holt-Winters指数平滑法
- **モデル**: 加法モデル（トレンドあり、季節性あり）
- **特徴**:
  - 季節性の自動検出（24時間周期）
  - 平滑化パラメータの最適化
  - 短期予測に適した手法
- **パラメータ**:
  - Alpha（レベル平滑化）
  - Beta（トレンド平滑化）
  - Gamma（季節性平滑化）

### 4. モデル評価
- **評価指標の詳細表示**:
  - MAE: 予測誤差の平均的な大きさ
  - RMSE: 大きな誤差をより重視
  - MAPE: パーセンテージでの誤差
- **モデルサマリー**: ARIMAの統計的有意性

### 5. 残差分析
- **時系列プロット**: 残差の時間的推移
- **ヒストグラム**: 残差の分布
- **Q-Qプロット**: 正規性の検定
- **自己相関（ACF）**: 残差の独立性検証

## 💡 使い方

### 統計分析の実行
1. 「詳細分析」タブを開く
2. エリアと年月を選択
3. 「統計分析実行」ボタンをクリック
4. 各タブで結果を確認

### AI予測の実行
1. 「AI分析」タブを開く
2. エリア、年月、目的系列を選択
3. 予測期間と訓練データ比率を設定
4. 希望する予測手法のボタンをクリック：
   - 📊 時系列分解（STL）
   - 📈 ARIMA予測
   - 📉 指数平滑法
5. 「予測結果」「モデル評価」「残差分析」タブで結果を確認

## 📦 必要な依存関係

```
scipy==1.11.4          # 科学計算ライブラリ
statsmodels==0.14.1    # 統計モデリング・時系列分析
```

インストール:
```powershell
pip install scipy==1.11.4 statsmodels==0.14.1
```

## 🎯 学術的な利点

### 統計分析
- データの特性を定量的に把握
- 異常値や外れ値の検出
- 発電方式間の関係性の理解
- 時間帯別の需要パターンの特定

### 時系列予測
- **STL分解**: データの構造理解、季節調整
- **ARIMA**: 短期〜中期予測、統計的根拠のある予測
- **指数平滑法**: 実装が簡単、計算が高速、直感的
- **モデル評価**: 予測精度の定量的評価、モデル選択の根拠

### 残差分析
- モデルの妥当性検証
- 予測の信頼性評価
- 改善の余地の特定

## 📚 参考文献

- Box, G. E. P., Jenkins, G. M., & Reinsel, G. C. (2015). Time Series Analysis: Forecasting and Control.
- Hyndman, R. J., & Athanasopoulos, G. (2021). Forecasting: Principles and Practice (3rd ed.).
- Cleveland, R. B., Cleveland, W. S., McRae, J. E., & Terpenning, I. (1990). STL: A Seasonal-Trend Decomposition.

## 🔮 将来の拡張

- 機械学習モデル（LSTM、Transformer）の統合
- 複数モデルのアンサンブル予測
- 自動的なハイパーパラメータ最適化
- 予測区間の表示
- Prophetモデルの追加
